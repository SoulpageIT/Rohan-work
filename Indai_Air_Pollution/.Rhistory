#2)DD-MM-YY
index<-grepl("[0-9]{2}-[0-9]{2}-[0-9]{2}", data$sampling_date)
format2<-data[index,]
View(format2)
sum(is.na(format2$sampling_date))
#3)DD/MM/YYYY
index<-grepl("[0-9]{2}/[0-9]{2}/[0-9]{4}",data$sampling_date)
format3<-data[index,]
sum(is.na(format3$sampling_date))
#4)M021990
index<-grepl("M[0-9]{6}",data$sampling_date)
#4)M021990
index<-grepl("M[0-9]{6}",data$sampling_date)
format4<-data[index,]
sum(is.na(format4$sampling_date))
format<-rbind(format2,format3)
mdy<-mdy(format$sampling_date)
dmy<-dmy(format$sampling_date)
mdy[is.na(mdy)]<-dmy[is.na(mdy)]
format$sampling_date<-mdy
sum(is.na(format4$sampling_date))
sum(is.na(format$sampling_date))
form<-rbind(format4,format)
mdy<-mdy(form$sampling_date)
dmy<-dmy(form$sampling_date)
mdy[is.na(mdy)]<-dmy[is.na(mdy)]
form$sampling_date<-mdy
sum(is.na(form$sampling_date))
View(form)
sum(is.na(form$sampling_date))
View(format3)
View(format3)
View(format4)
View(format4)
mdy<-mdy(data$sampling_date)
dmy<-dmy(format$sampling_date)
mdy[is.na(mdy)]<-dmy[is.na(mdy)]
format$sampling_date<-mdy
mdy<-mdy(data$sampling_date)
dmy<-dmy(format$sampling_date)
mdy[is.na(mdy)]<-dmy[is.na(mdy)]
data$sampling_date_dup<-mdy
View(data)
sum(is.na(data$sampling_date1))
sum(is.na(data$sampling_date_dup))
mdy<-mdy(data$sampling_date)
dmy<-dmy(data$sampling_date)
mdy[is.na(mdy)]<-dmy[is.na(mdy)]
data$sampling_date_dup<-mdy
sum(is.na(data$sampling_date_dup))
data[is.na(data$sampling_date_dup)]
data[is.na(data$sampling_date_dup),]
Na_data<-data[is.na(data$sampling_date_dup),]
Na_data[,c("sampling_date","sampling_date_dup")]
unique(data$sampling_date_dup)
unique(Na_data[,c("sampling_date","sampling_date_dup")][,c("sampling_date","sampling_date_dup")])
View(data)
unique(sampling_date_dup)
unique(data$sampling_date_dup)
unique(Na_data[,c("sampling_date","sampling_date_dup")])
unique(Na_data[,c("sampling_date","sampling_date_dup")][,c("sampling_date","sampling_date_dup")])
data[,c(data$sampling_date_dup)]
data$ID <- seq.int(nrow(data))
mdy<-mdy(data$sampling_date)
dmy<-dmy(data$sampling_date)
mdy[is.na(mdy)]<-dmy[is.na(mdy)]
data$sampling_date_dup<-mdy
sum(is.na(data$sampling_date_dup))
Na_data<-data[is.na(data$sampling_date_dup),]
Na_data[,c("sampling_date","sampling_date_dup")]
index<-grepl("M[0-9]{6}",Na_data$sampling_date)
subset1<-data[index,]
index<-grepl("M[0-9]{6}",Na_data$sampling_date)
subset1<-data[index,]
subset1<-Na_data[index,]
Na_data$sampling_date <- gsub('M','',Na_data$sampling_date)
Na_data$sampling_date
subset1$sampling_date <- gsub('M','',Na_data$sampling_date)
subset1$sampling_date <- gsub('M','',subset1$sampling_date)
rm(Na_data)
Na_data<-data[is.na(data$sampling_date_dup),]
Na_data$sampling_date
subset1
subset1$sampling_date_dup<-sampling_date
subset1$sampling_date_dup<-subset1$sampling_date
subset1
subset1<-Na_data[index,]
index<-grepl("[0-9]{2}/[0-9]{2}/[0-9]{4}",Na_data$sampling_date)
subset1<-Na_data[index,]
index<-grepl("M[0-9]{6}",Na_data$sampling_date)
subset1<-Na_data[index,]
subset1$sampling_date <- gsub('M','',subset1$sampling_date)
index<-grepl("[0-9]{2}/[0-9]{2}/[0-9]{4}",Na_data$sampling_date)
subset2<-Na_data[index,]
subset2
data[is.na(data$sampling_date),]
#For Reading and subsetting the data in analysis.
library(data.table)
#For Visulation.
library(ggplot2)
library(plotly)
#From this library we have used "revalue function" for replacing particular factor with other values in a column.
library(plyr)
#For regular expression in strings
#install.packages("stringr")
library(stringr)
#For making date column uniform we used
#install.packages("liburidate")
#install.packages("devtools")
#install.packages("lubridate")
library(lubridate)
data<-fread("data.csv",stringsAsFactors = T)
str(data)
na.omit(data$sampling_date)
summary(data)
data <- data[!(location=="Noida, Ghaziabad")]
revalue(data$location, c("Vishakhapatnam" = "Visakhapatnam","Panjim"="Panaji","ANKLESHWAR"="Ankleshwar","Anklesvar"="Ankleshwar","Silcher"="Silchar","Yamunanagar"="Yamuna Nagar","Kottayam"="Kotttayam","Trivendrum"="Trivandrum","Bombay"="Mumbai","Bhubaneshwar"="Bhubaneswar","Pondichery"="Pondicherry","Madras"="Chennai","Turicorin"="Tuticorin","Calcutta"="Kolkata","Durgapur (WB)"="Durgapur","Gajroula"="Gajraula","VAPI"="vapi")) -> data$location
revalue(data$type, c("Sensitive"="Sensitive Area","Sensitive Areas"="Sensitive Area","Industrial"="Industrial Area","Industrial Areas"="Industrial Area","Residential"="Residential and others")) -> data$type
unique(data$rspm)
unique(data$spm)
colnames(data)
indx <- setNames( rep(c('winter', 'spring', 'summer',
'Rainy'),each=3), c(c(11,12,1),c(2,3,4),c(5,6,7),c(8,9,10)))
data[,seasons := as.factor(unname(indx[ as.character(month(date))]))]
data_analysis<-data[,c("location","so2","no2","rspm","spm","pm2_5","date","type","seasons","year","month")]
data$ID <- seq.int(nrow(data))
mdy<-mdy(data$sampling_date)
dmy<-dmy(data$sampling_date)
mdy[is.na(mdy)]<-dmy[is.na(mdy)]
data$sampling_date_dup<-mdy
sum(is.na(data$sampling_date_dup))
Na_data<-data[is.na(data$sampling_date_dup),]
Na_data[,c("sampling_date","sampling_date_dup")]
unique(Na_data[,c("sampling_date","sampling_date_dup")])
index<-grepl("M[0-9]{6}",Na_data$sampling_date)
subset1<-Na_data[index,]
subset1$sampling_date <- gsub('M','',subset1$sampling_date)
index<-grepl("[0-9]{2}/[0-9]{2}/[0-9]{4}",Na_data$sampling_date)
subset2<-Na_data[index,]
subset2
index<-grepl("/",Na_data$sampling_date)
subset2<-Na_data[index,]
subset2
str_split_fixed(subset2$sampling_date, "/", 3)
buffer_data<-as.data.frame(str_split_fixed(subset2$sampling_date, "/", 3))
buffer_data<-as.data.table(str_split_fixed(subset2$sampling_date, "/", 3))
buffer_data
subset1
unique(Na_data[,c("sampling_date","sampling_date_dup")])
index<-grepl("M[0-9]{6}",Na_data$sampling_date)
subset1<-Na_data[index,]
subset1
index<-grepl("/",Na_data$sampling_date)
subset1<-Na_data[!index,]
data$ID <- seq.int(nrow(data))
mdy<-mdy(data$sampling_date)
dmy<-dmy(data$sampling_date)
mdy[is.na(mdy)]<-dmy[is.na(mdy)]
data$sampling_date_dup<-mdy
sum(is.na(data$sampling_date_dup))
Na_data<-data[is.na(data$sampling_date_dup),]
Na_data[,c("sampling_date","sampling_date_dup")]
unique(Na_data[,c("sampling_date","sampling_date_dup")])
index<-grepl("/",Na_data$sampling_date)
subset1<-Na_data[!index,]
subset1
subset1$sampling_date_dup <- gsub('M','',subset1$sampling_date)
subset1
subset2<-Na_data[index,]
subset2
buffer_data<-as.data.table(str_split_fixed(subset2$sampling_date, "/", 3))
buffer_data
buffer_data_Month_Year <- do.call(paste0, buffer_data[c("V3","V2")])
buffer_data_Month_Year <- do.call(paste0, buffer_data[,c("V3","V2")])
buffer_data$Month_Year <-do.call(paste0, buffer_data[,c("V3","V2")])
buffer_data<-as.data.table(str_split_fixed(subset2$sampling_date, "/", 3))
buffer_data$dash="-"
buffer_data
buffer_data$Month_Year <-do.call(paste0, buffer_data[,c("V3","dash","V2")])
buffer_id=subset2$ID
buffer_data$Month_Year <-do.call(paste0, buffer_data[,c("V3","dash","V2")])
buffer_data
buffer_data_id=subset2$ID
buffer_data$Month_Year <-do.call(paste0, buffer_data[,c("V3","dash","V2")])
buffer_data
buffer_data$id=subset2$ID
buffer_data$Month_Year <-do.call(paste0, buffer_data[,c("V3","dash","V2")])
buffer_data
subset2[,c("sampling_date","ID")]
misseddate$year<- substr(subset1$sampling_date_dup,nchar(as.character(subset1$sampling_date_dup))-3,nchar(as.character(subset1$sampling_date_dup)))
subset1$year<- substr(subset1$sampling_date_dup,nchar(as.character(subset1$sampling_date_dup))-3,nchar(as.character(subset1$sampling_date_dup)))
subset1$month<- substr(subset1$sampling_date_dup,2,3)
subset1$Month_Year<-do.call(paste0, buffer_data[,c("year","-","month")])
buffer_data$dash<-NULL
subset1$Month_Year<-do.call(paste0, buffer_data[,c("year","dash","month")])
subset1$year<- substr(subset1$sampling_date_dup,nchar(as.character(subset1$sampling_date_dup))-3,nchar(as.character(subset1$sampling_date_dup)))
subset1$month<- substr(subset1$sampling_date_dup,2,3)
subset1$dash<-"-"
subset1$Month_Year<-do.call(paste0, buffer_data[,c("year","dash","month")])
subset1$year<- substr(subset1$sampling_date_dup,nchar(as.character(subset1$sampling_date_dup))-3,nchar(as.character(subset1$sampling_date_dup)))
subset1$month<- substr(subset1$sampling_date_dup,2,3)
subset1$dash<-"-"
subset1$Month_Year<-do.call(paste0,subset1[,c("year","dash","month")])
subset1$month<-NULL
subset1
Na_data
Na_data
subset1
ggplotly(ggplot(data_analysis[,list("avgNO2"=mean(no2)),by=c("year","month")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(year)),group=1)+
geom_point()+ geom_line(linetype = "dashed",color="black")+facet_wrap(~as.factor(year))+labs(title = "Average No2 level in HYD by years",x="Months", y = "Average No2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
#For making date column uniform we used
#install.packages("liburidate")
#install.packages("devtools")
#install.packages("lubridate")
library(lubridate)
data<-fread("data.csv",stringsAsFactors = T)
str(data)
na.omit(data$sampling_date)
summary(data)
#Checking the NA 'S at entire data set.
cat("\nThe Number of NA 'S in data set :- ", sum(is.na(data)))
apply(data,2,function(x)sum(is.na(x)))
#Checking the number of null value in the data set.
cat("\nThe Number of Null VALUES 'S in data set :- ", sum(is.null(data)))
unique(data$stn_code)
unique(data$sampling_date)
unique(data$state)
unique(data$location)
data <- data[!(location=="Noida, Ghaziabad")]
revalue(data$location, c("Vishakhapatnam" = "Visakhapatnam","Panjim"="Panaji","ANKLESHWAR"="Ankleshwar","Anklesvar"="Ankleshwar","Silcher"="Silchar","Yamunanagar"="Yamuna Nagar","Kottayam"="Kotttayam","Trivendrum"="Trivandrum","Bombay"="Mumbai","Bhubaneshwar"="Bhubaneswar","Pondichery"="Pondicherry","Madras"="Chennai","Turicorin"="Tuticorin","Calcutta"="Kolkata","Durgapur (WB)"="Durgapur","Gajroula"="Gajraula","VAPI"="vapi")) -> data$location
unique(data$agency)
unique(data$type)
revalue(data$type, c("Sensitive"="Sensitive Area","Sensitive Areas"="Sensitive Area","Industrial"="Industrial Area","Industrial Areas"="Industrial Area","Residential"="Residential and others")) -> data$type
unique(data$so2)
unique(data$no2)
colnames(data)
indx <- setNames( rep(c('winter', 'spring', 'summer',
'Rainy'),each=3), c(c(11,12,1),c(2,3,4),c(5,6,7),c(8,9,10)))
data[,seasons := as.factor(unname(indx[ as.character(month(date))]))]
data$date<-as.Date(data$date,'%Y-%m-%d')
data$month<-month(data$date)
data$year<-year(data$date)
data_analysis<-data[,c("location","so2","no2","rspm","spm","pm2_5","date","type","seasons","year","month")]
data_analysis<-data_analysis[type=="Industrial Area" & location=="Hyderabad"]
ggplotly(ggplot(data_analysis[,list("avgNO2"=mean(no2)),by=c("year","month")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(year)),group=1)+
geom_point()+ geom_line(linetype = "dashed",color="black")+facet_wrap(~as.factor(year))+labs(title = "Average No2 level in HYD by years",x="Months", y = "Average No2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data_analysis[,list("avgsO2"=mean(so2)),by=c("year","month")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(year),group=1))+
geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average So2 level in HYD by years",x="Months", y = "Average So2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data_analysis[,list("avgNO2"=mean(no2)),by=c("year","seasons")],aes(x=as.factor(seasons),y=avgNO2,fill=as.factor(year),group=1)) +geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average No2 level in HYD by years",x="seasons", y = "Average No2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data_analysis[,list("avgsO2"=mean(so2)),by=c("year","seasons","month")],aes(x=as.factor(seasons),y=avgsO2,fill=as.factor(month),group=1))+
geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average So2 level in HYD by years",x="Months", y = "Average So2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
na.omit(data$state)
sum(is.na(data$state))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,list("avgNO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average No2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
data[state=="West Bengal",list("avgNO2"=mean(no2)),by=c("year","month","location")]
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="West Bengal",list("avgsO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average So2 level in location by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
na.omit(data$type)
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2)),by=c("month","type")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average No2 level in kolkata by type of area by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kolkata",list("so2"=mean(so2)),by=c("month","type")],aes(x=as.factor(month),y=so2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average so2 level in kolkata by type of area by months",x="Months", y = "Average so2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Howrah",list("avgNO2"=mean(no2)),by=c("month","type")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average No2 level in Howrah. by type of area by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Howrah",list("so2"=mean(so2)),by=c("month","type")],aes(x=as.factor(month),y=so2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average so2 level in Howrah by type of area by months",x="Months", y = "Average so2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgso2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgso2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgno2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgnO2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgnO2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+scale_y_continuous(sec.axis = sec_axis(~./max(avgnO2))))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgnO2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+scale_y_continuous(sec.axis = sec_axis(~./max(mean(data$no2)))))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgnO2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+scale_y_continuous(sec.axis = sec_axis(~./max(mean(data$no2)))))
View(data)
ggplotly(ggplot(data_analysis[,list("avgNO2"=mean(no2)),by=c("year","month")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(year)),group=1)+
geom_point()+ geom_line(linetype = "dashed",color="black")+facet_wrap(~as.factor(year))+labs(title = "Average No2 level in HYD by years",x="Months", y = "Average No2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
na.omit(data$state)
sum(is.na(data$state))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgnO2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+scale_y_continuous(sec.axis = sec_axis(~./max(mean(data$no2)))))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+geom_line(aes(x=as.factor(month), y=avgnO2),stat="identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+scale_y_continuous(sec.axis = sec_axis(~./max(mean(data$no2)))))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months"))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=avgnO2))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months"))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=avgnO2))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months"))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=avgnO2))+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,c("year","month","state","so2","no2")],aes(x=as.factor(month),y=so2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=no2))+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgNO2"=mean(so2)),by=c("month","type")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=no2))))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average No2 level in kolkata by type of area by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgNO2"=mean(so2)),by=c("month","type")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=no2)))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average No2 level in kolkata by type of area by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgNO2"=mean(so2)),by=c("month","type")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=no2))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average No2 level in kolkata by type of area by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
scale_y_continuous(sec.axis = sec_axis(~./max(mean(data$no2))))
ggplotly(ggplot(data[,list("avgNO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average No2 level in states by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=avgnO2))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months"))
ggplotly(ggplot(data[,c("year","month","state","so2","no2")],aes(x=as.factor(month),y=so2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=no2))+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=avgnO2))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=avgnO2))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
unique(data$type)
revalue(data$type, c("Sensitive"="Sensitive Area","Sensitive Areas"="Sensitive Area","Industrial"="Industrial Area","Industrial Areas"="Industrial Area","Residential"="Residential and others","Residential, Rural and other Areas"="Residential and others")) -> data$type
unique(data$type)
ggplotly(ggplot(data[location=="Howrah",list("so2"=mean(so2)),by=c("month","type")],aes(x=as.factor(month),y=so2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average so2 level in Howrah by type of area by months",x="Months", y = "Average so2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Howrah",list("avgNO2"=mean(no2)),by=c("month","type")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average No2 level in Howrah. by type of area by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
scale_y_continuous(sec.axis = sec_axis(~./max(mean(data$no2))))
ggplotly(ggplot(data[,list("avgNO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average No2 level in states by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Delhi",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average so2 level in location by months",x="Months", y = "Average So2 values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average so2 level in location by months",x="Months", y = "Average So2 values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
data_analysis$average_so2<-mean(data_analysis$so2)
data_analysis$average_no2<-mean(data_analysis$no2)
ggplotly(ggplot(avg[location==Kolkata,],aes(x=as.factor(month),y=avgNO2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=avgSO2))+geom_point(aes(y=avgSO2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data_analysis[location==Kolkata,],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data_analysis[location=="Kolkata",],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data_analysis[location=="Kolkata",],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data_analysis[location=="Kolkata",],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(as.factor(year)))
ggplotly(ggplot(data_analysis[location=="Kolkata"],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data_analysis[location=="Kolkata",.N,by=c("month","verage_so2","year","average_no2")],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data_analysis[location=="Kolkata",.N,by=c("month","average_so2","year","average_no2")],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data_analysis[location=="Kolkata",.N,by=c("month","average_so2","year","average_no2")],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(data_analysis$year)))
data_analysis[location=="Kolkata",.N,by=c("month","average_so2","year","average_no2")]
ggplotly(ggplot(data_analysis[location=="Kolkata",.N,by=c("month","average_so2","year","average_no2")],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(data_analysis$year)))
ggplotly(ggplot(data_analysis[location=="Kolkata",.N,by=c("month","average_so2","year","average_no2")],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(data_analysis$year)))
data_analysis[location=="Kolkata",.N,by=c("month","average_so2","year","average_no2")]
data[location=="Kolkata",list("avgNO2"=mean(no2)),by=c("month","type")]
data_analysis[location=="Kolkata",.N,by=c("month","average_so2","year","average_no2")]
ggplotly(ggplot(data_analysis[location=="Kolkata",by=c("month","average_so2","year","average_no2")],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(data_analysis$year)))
data_analysis[location=="Kolkata",by=c("month","average_so2","year","average_no2")]
data_analysis[location=="Kolkata",c("month","average_so2","year","average_no2")]
data[location=="Kolkata",list("avgNO2"=mean(no2)),by=c("month","type")]
data$average_so2<-mean(data_analysis$so2)
data$average_no2<-mean(data_analysis$no2)
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average so2 level in location by months",x="Months", y = "Average So2 values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[location=="Kolkata",c("month","average_so2","year","average_no2")],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(data_analysis$year)))
ggplotly(ggplot(data[location=="Kolkata",.N,c("month","average_so2","year","average_no2")],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(data_analysis$year)))
data[location=="Kolkata"]
ggplotly(ggplot(data[location=="Kolkata"],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(data_analysis$year)))
ggplotly(ggplot(data[location=="Kolkata"],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
data[location=="Kolkata"]
data$average_so2<-mean(data_analysis$so2)
data$average_no2<-mean(data_analysis$no2)
mean(data_analysis$so2)
data$average_so2<-mean(data$so2)
data$average_no2<-mean(data$no2)
data$average_so2<-mean(data$so2)
data$average_no2<-mean(data$no2)
average_so2
unique(data$average_so2)
avg<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2))]
avg<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),]
avg<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=colname(data)]
avg<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=colnames(data)]
avg<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=colnames(data)]
colnames(data)
avg<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("stn_code","sampling_date","state","location","agency","type","so2","no2","rspm","spm"    "location_monitoring_station" "pm2_5" ,"date" ,"seasons","month", "year","average_so2","average_no2")]
avg<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("stn_code","sampling_date","state","location","agency","type","so2","no2","rspm","spm"    "location_monitoring_station" ,"pm2_5" ,"date" ,"seasons","month", "year","average_so2","average_no2")]
avg<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("stn_code","sampling_date","state","location","agency","type","so2","no2","rspm","spm"    ,"pm2_5" ,"date" ,"seasons","month", "year","average_so2","average_no2")]
data<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("stn_code","sampling_date","state","location","agency","type","so2","no2","rspm","spm"    ,"pm2_5" ,"date" ,"seasons","month", "year","average_so2","average_no2")]
ggplotly(ggplot(data_analysis[,list("avgNO2"=mean(no2)),by=c("year","month")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(year)),group=1)+
geom_point()+ geom_line(linetype = "dashed",color="black")+facet_wrap(~as.factor(year))+labs(title = "Average No2 level in HYD by years",x="Months", y = "Average No2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data_analysis[,list("avgsO2"=mean(so2)),by=c("year","month")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(year),group=1))+
geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average So2 level in HYD by years",x="Months", y = "Average So2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data_analysis[,list("avgNO2"=mean(no2)),by=c("year","seasons")],aes(x=as.factor(seasons),y=avgNO2,fill=as.factor(year),group=1)) +geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average No2 level in HYD by years",x="seasons", y = "Average No2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data_analysis[,list("avgsO2"=mean(so2)),by=c("year","seasons","month")],aes(x=as.factor(seasons),y=avgsO2,fill=as.factor(month),group=1))+
geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average So2 level in HYD by years",x="Months", y = "Average So2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
na.omit(data$state)
sum(is.na(data$state))
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=avgnO2))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
scale_y_continuous(sec.axis = sec_axis(~./max(mean(data$no2))))
ggplotly(ggplot(data[,list("avgNO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average No2 level in states by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average so2 level in location by months",x="Months", y = "Average So2 values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[location=="Kolkata"],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
data[location=="Kolkata"]
ggplotly(ggplot(data[location=="Kolkata"],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[state=="West Bengal",list("avgsO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average So2 level in location by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2)),by=c("month","type")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(type))+labs(title = "Average No2 level in kolkata by type of area by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Howrah",],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity")+
geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=average_so2,fill=factor(month)))+geom_bar(stat = "identity"))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=average_so2,fill=month))+geom_bar(stat = "identity"))
#geom_line(aes(y=average_no2))+geom_point(aes(y=average_no2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=month))+geom_bar(stat = "identity"))
+geom_line(aes(y=avgNO2))+geom_point(aes(y=data$avgNO2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=month))+geom_bar(stat = "identity"))
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=month))+geom_bar(stat = "identity"))
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=month))+geom_bar(stat = "identity"))
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=month))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year)))
View(data)
data$average_so2=NULL
data$average_no2=NULL
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year)))
data[location=="Kolkata",]
View(data)
data<-data[,list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("state","location","agency","type","so2","no2" ,"date" ,"seasons","month", "year")]
ggplotly(ggplot(data[location=="Kolkata",],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year)))
View(avg)
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgSO2"=mean(no2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgSO2"=mean(no2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year)))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgSO2"=mean(no2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas level in city  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas level in city  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas level in city  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="West Bengal",list("avgsO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average So2 level in location by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
#For Reading and subsetting the data in analysis.
library(data.table)
#For Visulation.
library(ggplot2)
library(plotly)
#From this library we have used "revalue function" for replacing particular factor with other values in a column.
library(plyr)
#For regular expression in strings
#install.packages("stringr")
library(stringr)
#For making date column uniform we used
#install.packages("liburidate")
#install.packages("devtools")
#install.packages("lubridate")
library(lubridate)
ggplotly(ggplot(data_analysis[,list("avgNO2"=mean(no2)),by=c("year","month")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(year)),group=1)+
geom_point()+ geom_line(linetype = "dashed",color="black")+facet_wrap(~as.factor(year))+labs(title = "Average No2 level in HYD by years",x="Months", y = "Average No2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data_analysis[,list("avgsO2"=mean(so2)),by=c("year","month")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(year),group=1))+
geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average So2 level in HYD by years",x="Months", y = "Average So2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data_analysis[,list("avgNO2"=mean(no2)),by=c("year","seasons")],aes(x=as.factor(seasons),y=avgNO2,fill=as.factor(year),group=1)) +geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average No2 level in HYD by years",x="seasons", y = "Average No2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data_analysis[,list("avgsO2"=mean(so2)),by=c("year","seasons","month")],aes(x=as.factor(seasons),y=avgsO2,fill=as.factor(month),group=1))+
geom_line(linetype = "dashed",color="black")+geom_point()+facet_wrap(~as.factor(year))+labs(title = "Average So2 level in HYD by years",x="Months", y = "Average So2 value",fill="years")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[,list("avgsO2"=mean(so2),"avgnO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgsO2,fill=as.factor(month),group=1))+geom_line(aes(x=as.factor(month),y=avgnO2))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average So2 level in stats by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
scale_y_continuous(sec.axis = sec_axis(~./max(mean(data$no2))))
ggplotly(ggplot(data[,list("avgNO2"=mean(no2)),by=c("year","month","state")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(state))+labs(title = "Average No2 level in states by months",x="Months", y = "Average So2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="West Bengal",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average so2 level in location by months",x="Months", y = "Average So2 values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas level in city  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas level in Kolkata  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Howrah",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas level in Kolkata  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Howrah",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas level in Howrah  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kolkata",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Kolkata  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Howrah",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Howrah  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Bihar",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="Bihar",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Bihar",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Bihar",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average so2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Bihar",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average So2 level in location by months",x="Months", y = "Average so2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Dhanbad",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Howrah  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Dhanbad",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Dhanbad  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Jharia",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Jharia  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Sindri",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Sindri  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Delhi",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Sindri  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Delhi",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Delhi  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Rajasthan",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Rajasthan",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average so2 level in location by months",x="Months", y = "Average So2 values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black"))+coord_flip())
ggplotly(ggplot(data[state=="Rajasthan",list("avgNO2"=mean(so2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average so2 level in location by months",x="Months", y = "Average So2 values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Kota",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Delhi  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kota",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Delhi  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Kota",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Kota  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Alwar",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Alwar  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Jaipur.",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Jaipur  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Jaipur",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Jaipur  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Guijarat",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[state=="Guijarat",list("avgNO2"=mean(no2)),by=c("year","month","location")],aes(x=as.factor(month),y=avgNO2,fill=as.factor(month),group=1))+geom_bar(stat = "identity")+facet_wrap(~as.factor(location))+labs(title = "Average No2 level in location by months",x="Months", y = "Average No2 value",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
ggplotly(ggplot(data[location=="Jaipur",list("avgNO2"=mean(no2),"avgSO2"=mean(so2)),by=c("month","year")],aes(x=as.factor(month),y=avgSO2,fill=as.factor(month)))+geom_bar(stat = "identity")
+geom_line(aes(y=avgNO2))+geom_point(aes(y=avgNO2))+facet_wrap(~as.factor(year))+labs(title = "Average gas trend in Jaipur  by month and year",x="Months", y = "Average gas values",fill="months")+theme(plot.title = element_text(hjust = 0.5,face = "bold",color = "black")))
