library(mltools)
library(corrplot)
#for correlation
library(kableExtra)
#library for ROC curve
library(ROCR)
library(car)
hr<-fread("WA_Fn-UseC_-HR-Employee-Attrition.csv",na.strings = "NA",stringsAsFactors = TRUE,drop = c("Over18","EmployeeCount","EmployeeNumber","StandardHours"))
fact_columns<-c("Education", "EnvironmentSatisfaction","JobInvolvement","JobLevel","JobSatisfaction","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
hr<-as.data.frame(hr)
hr[fact_columns]<-lapply(hr[fact_columns], as.factor)
hr<-as.data.table(hr)
#library for graphs
library(ggplot2)
library(plotly)
#library for importing the data set.
library(data.table)
#sample.split function packages
library(caTools)
#The library for cross validation
library(caret)
library(mlbench)
#decision tree model building packages
library(rpart)
#decision tree plotting packages
library(RColorBrewer)
library(rattle)
#The package for random forest function
library(randomForest)
#packages for xgboost
library(xgboost)
library(Matrix)
#for encoding
library(mltools)
library(corrplot)
#for correlation
library(kableExtra)
#library for ROC curve
library(ROCR)
library(car)
hr<-fread("WA_Fn-UseC_-HR-Employee-Attrition.csv",na.strings = "NA",stringsAsFactors = TRUE,drop = c("Over18","EmployeeCount","EmployeeNumber","StandardHours"))
#hr$monthbydaily<-hr$MonthlyRate/hr$DailyRate
#hr$dailybyhourly<-hr$DailyRate/hr$HourlyRate
fact_columns<-c("Education", "EnvironmentSatisfaction","JobInvolvement","JobLevel","JobSatisfaction","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
hr<-as.data.frame(hr)
hr[fact_columns]<-lapply(hr[fact_columns], as.factor)
hr<-as.data.table(hr)
ggplotly(ggplot(hr,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on complete data set",x ="classes", y = "Their frequency"))
prop.table(table(hr$Attrition))
set.seed(1)
sample = sample.split(hr$Attrition, SplitRatio = .80)
train = subset(hr, sample == TRUE)
test  = subset(hr, sample == FALSE)
ggplotly(ggplot(train,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on Train data set",x ="classes", y = "Their frequency"))
prop.table(table(train$Attrition))
str(hr)
table(Actualvalue = test$Attrition, Predictedvalue = y_pred > 0.5)
y_pred <- predict(logistic_regression, newdata = test,type = "response")
#library for graphs
library(ggplot2)
library(plotly)
#library for importing the data set.
library(data.table)
#sample.split function packages
library(caTools)
#The library for cross validation
library(caret)
library(mlbench)
#decision tree model building packages
library(rpart)
#decision tree plotting packages
library(RColorBrewer)
library(rattle)
#The package for random forest function
library(randomForest)
#packages for xgboost
library(xgboost)
library(Matrix)
#for encoding
library(mltools)
library(corrplot)
#for correlation
library(kableExtra)
#library for ROC curve
library(ROCR)
library(car)
hr<-fread("WA_Fn-UseC_-HR-Employee-Attrition.csv",na.strings = "NA",stringsAsFactors = TRUE,drop = c("Over18","EmployeeCount","EmployeeNumber","StandardHours"))
fact_columns<-c("Education", "EnvironmentSatisfaction","JobInvolvement","JobLevel","JobSatisfaction","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
hr<-as.data.frame(hr)
hr[fact_columns]<-lapply(hr[fact_columns], as.factor)
hr<-as.data.table(hr)
ggplotly(ggplot(hr,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on complete data set",x ="classes", y = "Their frequency"))
prop.table(table(hr$Attrition))
set.seed(1)
sample = sample.split(hr$Attrition, SplitRatio = .80)
train = subset(hr, sample == TRUE)
test  = subset(hr, sample == FALSE)
ggplotly(ggplot(train,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on Train data set",x ="classes", y = "Their frequency"))
prop.table(table(train$Attrition))
str(hr)
factor_columns <- c("Attrition", "BusinessTravel","Department","Education","EducationField","EnvironmentSatisfaction","Gender","JobInvolvement","JobLevel","JobRole","JobSatisfaction","MaritalStatus","OverTime","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
numberic_columns<-c("Age","DailyRate","DistanceFromHome","HourlyRate","MonthlyIncome","MonthlyRate","NumCompaniesWorked","PercentSalaryHike","TotalWorkingYears","TrainingTimesLastYear","YearsAtCompany","YearsInCurrentRole","YearsSinceLastPromotion","YearsWithCurrManager")
# creating a dataframe of categorical features
hr<-as.data.frame(hr)
num_data<-hr[,numberic_columns]
fact_data<- hr[,factor_columns]
hr<-as.data.table(hr)
# creating dummy variables for factor attributes
dummies<- data.frame(sapply(fact_data,
function(x) data.frame(model.matrix(~x-1,data =fact_data))[,-1]))
# converting target variable attrition from No/Yes character to factorwith levels 0/1
dummies$Attrition<- as.numeric(dummies$Attrition)
# Final dataset
hr_final<- cbind(num_data,dummies)
set.seed(1)
sample = sample.split(hr_final$Attrition, SplitRatio = .80)
train = subset(hr_final, sample == TRUE)
test  = subset(hr_final, sample == FALSE)
colnames(train)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobLevel.x5+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
#library for graphs
library(ggplot2)
library(plotly)
#library for importing the data set.
library(data.table)
#sample.split function packages
library(caTools)
#The library for cross validation
library(caret)
library(mlbench)
#decision tree model building packages
library(rpart)
#decision tree plotting packages
library(RColorBrewer)
library(rattle)
#The package for random forest function
library(randomForest)
#packages for xgboost
library(xgboost)
library(Matrix)
#for encoding
library(mltools)
library(corrplot)
#for correlation
library(kableExtra)
#library for ROC curve
library(ROCR)
library(car)
hr<-fread("WA_Fn-UseC_-HR-Employee-Attrition.csv",na.strings = "NA",stringsAsFactors = TRUE,drop = c("Over18","EmployeeCount","EmployeeNumber","StandardHours"))
#hr$monthbydaily<-hr$MonthlyRate/hr$DailyRate
#hr$dailybyhourly<-hr$DailyRate/hr$HourlyRate
fact_columns<-c("Education", "EnvironmentSatisfaction","JobInvolvement","JobLevel","JobSatisfaction","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
hr<-as.data.frame(hr)
hr[fact_columns]<-lapply(hr[fact_columns], as.factor)
hr<-as.data.table(hr)
ggplotly(ggplot(hr,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on complete data set",x ="classes", y = "Their frequency"))
prop.table(table(hr$Attrition))
set.seed(1)
sample = sample.split(hr$Attrition, SplitRatio = .80)
train = subset(hr, sample == TRUE)
test  = subset(hr, sample == FALSE)
ggplotly(ggplot(train,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on Train data set",x ="classes", y = "Their frequency"))
prop.table(table(train$Attrition))
str(hr)
factor_columns <- c("Attrition", "BusinessTravel","Department","Education","EducationField","EnvironmentSatisfaction","Gender","JobInvolvement","JobLevel","JobRole","JobSatisfaction","MaritalStatus","OverTime","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
numberic_columns<-c("Age","DailyRate","DistanceFromHome","HourlyRate","MonthlyIncome","MonthlyRate","NumCompaniesWorked","PercentSalaryHike","TotalWorkingYears","TrainingTimesLastYear","YearsAtCompany","YearsInCurrentRole","YearsSinceLastPromotion","YearsWithCurrManager")
# creating a dataframe of categorical features
hr<-as.data.frame(hr)
num_data<-hr[,numberic_columns]
fact_data<- hr[,factor_columns]
hr<-as.data.table(hr)
# creating dummy variables for factor attributes
dummies<- data.frame(sapply(fact_data,
function(x) data.frame(model.matrix(~x-1,data =fact_data))[,-1]))
# converting target variable attrition from No/Yes character to factorwith levels 0/1
dummies$Attrition<- as.numeric(dummies$Attrition)
# Final dataset
hr_final<- cbind(num_data,dummies)
set.seed(1)
sample = sample.split(hr_final$Attrition, SplitRatio = .80)
train = subset(hr_final, sample == TRUE)
test  = subset(hr_final, sample == FALSE)
colnames(train)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobLevel.x5+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
y_pred <- predict(logistic_regression, newdata = test,type = "response")
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+       JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
vif(logistic_regression)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+       JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
#library for graphs
library(ggplot2)
library(plotly)
#library for importing the data set.
library(data.table)
#sample.split function packages
library(caTools)
#The library for cross validation
library(caret)
library(mlbench)
#decision tree model building packages
library(rpart)
#decision tree plotting packages
library(RColorBrewer)
library(rattle)
#The package for random forest function
library(randomForest)
#packages for xgboost
library(xgboost)
library(Matrix)
#for encoding
library(mltools)
library(corrplot)
#for correlation
library(kableExtra)
#library for ROC curve
library(ROCR)
library(car)
hr<-fread("WA_Fn-UseC_-HR-Employee-Attrition.csv",na.strings = "NA",stringsAsFactors = TRUE,drop = c("Over18","EmployeeCount","EmployeeNumber","StandardHours"))
fact_columns<-c("Education", "EnvironmentSatisfaction","JobInvolvement","JobLevel","JobSatisfaction","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
hr<-as.data.frame(hr)
hr[fact_columns]<-lapply(hr[fact_columns], as.factor)
hr<-as.data.table(hr)
ggplotly(ggplot(hr,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on complete data set",x ="classes", y = "Their frequency"))
prop.table(table(hr$Attrition))
set.seed(1)
sample = sample.split(hr$Attrition, SplitRatio = .80)
train = subset(hr, sample == TRUE)
test  = subset(hr, sample == FALSE)
ggplotly(ggplot(train,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on Train data set",x ="classes", y = "Their frequency"))
prop.table(table(train$Attrition))
str(hr)
factor_columns <- c("Attrition", "BusinessTravel","Department","Education","EducationField","EnvironmentSatisfaction","Gender","JobInvolvement","JobLevel","JobRole","JobSatisfaction","MaritalStatus","OverTime","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
numberic_columns<-c("Age","DailyRate","DistanceFromHome","HourlyRate","MonthlyIncome","MonthlyRate","NumCompaniesWorked","PercentSalaryHike","TotalWorkingYears","TrainingTimesLastYear","YearsAtCompany","YearsInCurrentRole","YearsSinceLastPromotion","YearsWithCurrManager")
# creating a dataframe of categorical features
hr<-as.data.frame(hr)
num_data<-hr[,numberic_columns]
fact_data<- hr[,factor_columns]
hr<-as.data.table(hr)
# creating dummy variables for factor attributes
dummies<- data.frame(sapply(fact_data,
function(x) data.frame(model.matrix(~x-1,data =fact_data))[,-1]))
# creating a dataframe of categorical features
hr<-as.data.frame(hr)
num_data<-hr[,numberic_columns]
fact_data<- hr[,factor_columns]
hr<-as.data.table(hr)
# creating dummy variables for factor attributes
dummies<- data.frame(sapply(fact_data,
function(x) data.frame(model.matrix(~x-1,data =fact_data))[,-1]))
# creating dummy variables for factor attributes
dummies<- data.frame(sapply(fact_data,
function(x) data.frame(model.matrix(~x-1,data =fact_data))[,-1]))
# converting target variable attrition from No/Yes character to factorwith levels 0/1
dummies$Attrition<- as.numeric(dummies$Attrition)
# Final dataset
hr_final<- cbind(num_data,dummies)
set.seed(1)
sample = sample.split(hr_final$Attrition, SplitRatio = .80)
train = subset(hr_final, sample == TRUE)
test  = subset(hr_final, sample == FALSE)
colnames(train)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobLevel.x5+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
View(train)
colnames(train)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobLevel.x5+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
#library for graphs
library(ggplot2)
library(plotly)
#library for importing the data set.
library(data.table)
#sample.split function packages
library(caTools)
#The library for cross validation
library(caret)
library(mlbench)
#decision tree model building packages
library(rpart)
#decision tree plotting packages
library(RColorBrewer)
library(rattle)
#The package for random forest function
library(randomForest)
#packages for xgboost
library(xgboost)
library(Matrix)
#for encoding
library(mltools)
library(corrplot)
#for correlation
library(kableExtra)
#library for ROC curve
library(ROCR)
library(car)
hr<-fread("WA_Fn-UseC_-HR-Employee-Attrition.csv",na.strings = "NA",stringsAsFactors = TRUE,drop = c("Over18","EmployeeCount","EmployeeNumber","StandardHours"))
fact_columns<-c("Education", "EnvironmentSatisfaction","JobInvolvement","JobLevel","JobSatisfaction","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
hr<-as.data.frame(hr)
hr[fact_columns]<-lapply(hr[fact_columns], as.factor)
hr<-as.data.table(hr)
ggplotly(ggplot(hr,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on complete data set",x ="classes", y = "Their frequency"))
prop.table(table(hr$Attrition))
set.seed(1)
sample = sample.split(hr$Attrition, SplitRatio = .80)
train = subset(hr, sample == TRUE)
test  = subset(hr, sample == FALSE)
ggplotly(ggplot(train,aes(x=Attrition,fill=Attrition))+geom_bar(width = 0.2)+geom_text(stat="count", aes(label=..count..), vjust=-0.3)+labs(title = "The class imbalance check on Train data set",x ="classes", y = "Their frequency"))
prop.table(table(train$Attrition))
str(hr)
factor_columns <- c("Attrition", "BusinessTravel","Department","Education","EducationField","EnvironmentSatisfaction","Gender","JobInvolvement","JobLevel","JobRole","JobSatisfaction","MaritalStatus","OverTime","PerformanceRating","RelationshipSatisfaction","StockOptionLevel","WorkLifeBalance")
numberic_columns<-c("Age","DailyRate","DistanceFromHome","HourlyRate","MonthlyIncome","MonthlyRate","NumCompaniesWorked","PercentSalaryHike","TotalWorkingYears","TrainingTimesLastYear","YearsAtCompany","YearsInCurrentRole","YearsSinceLastPromotion","YearsWithCurrManager")
# creating a dataframe of categorical features
hr<-as.data.frame(hr)
num_data<-hr[,numberic_columns]
fact_data<- hr[,factor_columns]
hr<-as.data.table(hr)
# creating dummy variables for factor attributes
dummies<- data.frame(sapply(fact_data,
function(x) data.frame(model.matrix(~x-1,data =fact_data))[,-1]))
# converting target variable attrition from No/Yes character to factorwith levels 0/1
dummies$Attrition<- as.numeric(dummies$Attrition)
# Final dataset
hr_final<- cbind(num_data,dummies)
set.seed(1)
sample = sample.split(hr_final$Attrition, SplitRatio = .80)
train = subset(hr_final, sample == TRUE)
test  = subset(hr_final, sample == FALSE)
colnames(train)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobLevel.x5+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+       JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+Attrition+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+       JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyIncome+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+                    BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xResearch...Development+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Department.xSales+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
vif(logistic_regression)
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+YearsAtCompany                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
logistic_regression<-glm(Attrition~ Age+DailyRate +DistanceFromHome +HourlyRate+MonthlyRate+NumCompaniesWorked+PercentSalaryHike                +TotalWorkingYears+TrainingTimesLastYear+YearsAtCompany+YearsInCurrentRole+YearsSinceLastPromotion+YearsWithCurrManager+                      BusinessTravel.xTravel_Frequently+BusinessTravel.xTravel_Rarely+Education.x2+                      Education.x3+Education.x4+Education.x5+EducationField.xLife.Sciences+EducationField.xMarketing+EducationField.xMedical+EducationField.xOther              +EducationField.xTechnical.Degree+EnvironmentSatisfaction.x2+EnvironmentSatisfaction.x3+EnvironmentSatisfaction.x4+Gender+
JobInvolvement.x2+JobInvolvement.x3+JobInvolvement.x4+JobLevel.x2+JobLevel.x3+JobLevel.x4+JobRole.xHuman.Resources+          JobRole.xLaboratory.Technician+JobRole.xManager+JobRole.xManufacturing.Director+JobRole.xResearch.Director+
JobRole.xResearch.Scientist+JobRole.xSales.Executive+JobRole.xSales.Representative+JobSatisfaction.x2+
JobSatisfaction.x3+JobSatisfaction.x4+MaritalStatus.xMarried+MaritalStatus.xSingle+OverTime+PerformanceRating+RelationshipSatisfaction.x2+     RelationshipSatisfaction.x3+RelationshipSatisfaction.x4+StockOptionLevel.x1+StockOptionLevel.x2+StockOptionLevel.x3+WorkLifeBalance.x2+ WorkLifeBalance.x3+WorkLifeBalance.x4,family = "binomial",data=train)
summary(logistic_regression)
sum(train =="")
#library for graphs
library(ggplot2)
library(plotly)
#library for importing the data set.
library(data.table)
#sample.split function packages
library(caTools)
#The library for cross validation
library(caret)
library(mlbench)
#decision tree model building packages
library(rpart)
#decision tree plotting packages
library(RColorBrewer)
library(rattle)
#The package for random forest function
library(randomForest)
#packages for xgboost
library(xgboost)
library(Matrix)
#for encoding
library(mltools)
library(corrplot)
#for correlation
library(kableExtra)
#library for ROC curve
library(ROCR)
library(car)
